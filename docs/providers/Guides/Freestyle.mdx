import { Flex, Image, Heading } from "@chakra-ui/react";
import { CodeBlock } from "@theme/codeblock";

# Freestyle

:::note
Please make sure you invite Vital to your practice as a clinician with admin rights. To connect a user to Vital you must first connect your Freestyle practice to Vital.
Vital has two practices (depending on environment):

| Environment |                  |
| ----------- | ---------------- |
| Sandbox     | tryVital-sandbox |
| Production  | tryVital         |

If you get stuck at any point, help is just a click away! Join our Slack channel or send us a message to support@tryvital.io
:::

:::caution
Libre's API unfortunately does not record the timestamp offset associated with each user.
Although Vital reports a timestamp such as "2022-04-20T13:02:01.123664+00:00" this is not
a true utc time for libre, this time will be the time in the users timezone.
This is because libre does not report timezones via their API, Hence, Vital cannot infer the timezone offset.
Our recommendation is for the developer integrating with Vital to record the timezone offset
of each user and adjust the timestamps according to the users timezone.
:::

Once your Freestyle practice is connected to the Vital practice, you need to instruct your user's to connect their Libre account to your practice.
This allows Vital to start pulling data from their account. This can be through the Libre app.

<br />

<Image src={"/img/connect_libreview.png"} width={"40%"} ml={"20%"} />

<br />
<br />

Once your user has connected their Libre account, you can connect your user to Vital
either via the **widget** or the **API**.

## Vital Widget

To connect your user to Vital via the Widget you can follow the guide [here](../../vital-link/launching_link).

<br />

<Image src={"/img/libre_connect.png"} width={"40%"} ml={"20%"} />

<br />

## Vital Link

1. To connect to Freestyle Libre, you must create a Vital Link token.

<CodeBlock title={"Connecting email provider"} include_client_instantiation={true}>

```python
link_token = client.Link.create(user_id)
```

```js
const { link_token } = await client.Link.create(userId);
```

</CodeBlock>
<br />

2. Libre is an [_email_](../../vital-link/customization#email) provider.
   This means that when connecting a user we have to use
   the connect email provider method, passing in the email of the user's Libre account.
   <br />

<CodeBlock title={"Connecting email provider"} include_client_instantiation={true}>

```python
client.Link.email_provider(link_token, provider, email)
```

```js
await client.Link.connectEmailProvider(link_token, "freestyle_libre", email);
```

</CodeBlock>

<br />

<br />

Once this is complete we will start syncing data from their [Libre account](../../api/data_flow).
